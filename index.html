<html>

<head>
  <title>Anniversaires</title>
  <style>
    .date {
      text-decoration: underline;
    }

    .reverse {
      display: inline-block;
      transform: scale(-1, 1);
      color: red;
      direction: rtl;
    }

    h3 {
      margin: 0;
    }
  </style>
</head>


<body>
  <script>
    const aujourdhui = new Date();
    var dateEnTexte = function (date) {
      return `<span class="date">${date.toLocaleTimeString(`fr`, { weekday: `long`, year: `numeric`, month: `long`, day: `numeric` }).split(` `).slice(0, 4).join(` `)}</span>`;
    };
    var age = function (date) {
      var utc1 = new Date(aujourdhui.getFullYear(), aujourdhui.getMonth(), aujourdhui.getDate());
      var utc2 = new Date(aujourdhui.getFullYear(), date.getMonth(), date.getDate());
      if (utc1 > utc2) {
        utc2.setFullYear(utc2.getFullYear() + 1);
      }
      return utc2.getYear() - date.getYear();
    };
    var prochainAnniversaire = function (date) {
      var utc1 = new Date(aujourdhui.getFullYear(), aujourdhui.getMonth(), aujourdhui.getDate());
      var utc2 = new Date(aujourdhui.getFullYear(), date.getMonth(), date.getDate());
      if (utc1 > utc2) {
        utc2.setFullYear(utc2.getFullYear() + 1);
      }
      return utc2;
    };
    var joursVersAnniversaire = function (date) {
      const _MS_PAR_JOUR = 1000 * 60 * 60 * 24;
      var utc1 = new Date(aujourdhui.getFullYear(), aujourdhui.getMonth(), aujourdhui.getDate());
      var utc2 = prochainAnniversaire(date);
      return Math.floor((utc2 - utc1) / _MS_PAR_JOUR);
    };
    var familleAnniversaire = [
      {
        nom: `Martin`,
        signe: `Capricorne et Rat`,
        anniversaire: new Date(1973, 1 - 1, 4)
      }, {
        nom: `Nicolas`,
        signe: `Verseau et Chien`,
        anniversaire: new Date(2019, 1 - 1, 30)
      }, {
        nom: `Nadia`,
        signe: `Verseau et Dragon`,
        anniversaire: new Date(1979, 2 - 1, 5)
      }, {
        nom: `Christopher`,
        signe: `Verseau et Chien`,
        anniversaire: new Date(1982, 2 - 1, 12)
      }, {
        nom: `Dorothée`,
        signe: `Poisson et Lièvre`,
        anniversaire: new Date(1951, 3 - 1, 9)
      }, {
        nom: `Brigitte`,
        signe: `Poisson et Chien`,
        anniversaire: new Date(1982, 3 - 1, 12)
      }, {
        nom: `Simon`,
        signe: `Bélier et Coq`,
        anniversaire: new Date(2005, 3 - 1, 24)
      }, {
        nom: `Georges`,
        signe: `Bélier et Coq`,
        anniversaire: new Date(2017, 4 - 1, 3)
      }, {
        nom: `Moanaragi`,
        signe: `Bélier et Chien`,
        anniversaire: new Date(2018, 4 - 1, 11)
      }, {
        nom: `Vaimoana`,
        signe: `Bélier et Coq`,
        anniversaire: new Date(2005, 4 - 1, 13)
      }, {
        nom: `Sandra`,
        signe: `Bélier et Serpent`,
        anniversaire: new Date(1977, 4 - 1, 13)
      }, {
        nom: `Vadim`,
        signe: `Bélier et Cheval`,
        anniversaire: new Date(2014, 4 - 1, 15)
      }, {
        nom: `Christian`,
        signe: `Taureau et Lièvre`,
        anniversaire: new Date(1951, 5 - 1, 8)
      }, {
        nom: `Edouard`,
        signe: `Taureau et Cheval`,
        anniversaire: new Date(2014, 5 - 1, 16)
      }, {
        nom: `Ravahere`,
        signe: `Gémeaux et Chien`,
        anniversaire: new Date(1982, 6 - 1, 8)
      }, {
        nom: `Justin`,
        signe: `Gémeaux et Cochon`,
        anniversaire: new Date(2007, 6 - 1, 18)
      }, {
        nom: `Ariimoana`,
        signe: `Cancer et Serpent`,
        anniversaire: new Date(2013, 7 - 1, 11)
      }, {
        nom: `Victor`,
        signe: `Cancer et Rat`,
        anniversaire: new Date(2008, 7 - 1, 21)
      }, {
        nom: `Elena`,
        signe: `Lion et Singe`,
        anniversaire: new Date(2016, 7 - 1, 30)
      }, {
        nom: `Charles`,
        signe: `Lion et Singe`,
        anniversaire: new Date(1992, 8 - 1, 13)
      }, {
        nom: `Marie`,
        signe: `Vierge et Coq`,
        anniversaire: new Date(1945, 9 - 1, 1)
      }, {
        nom: `Maximin`,
        signe: `Balance et Cheval`,
        anniversaire: new Date(1978, 10 - 1, 4)
      }, {
        nom: `Cécile`,
        signe: `Balance et Serpent`,
        anniversaire: new Date(1977, 10 - 1, 5)
      }, {
        nom: `Christian`,
        signe: `Scorpion et Lièvre`,
        anniversaire: new Date(1975, 10 - 1, 23)
      }, {
        nom: `Julien`,
        signe: `Sagittaire et Chien`,
        anniversaire: new Date(1970, 11 - 1, 27)
      }, {
        nom: `Lucia`,
        signe: `Sagittaire et Rat`,
        anniversaire: new Date(2014, 12 - 1, 17)
      }
    ];
    var familleAnniversaireMariage = [
      {
        nom: `Christian & Cécile`,
        anniversaire: new Date(2005, 2 - 1, 26)
      }, {
        nom: `Christian & Dorothée`,
        anniversaire: new Date(1977, 3 - 1, 25)
      }, {
        nom: `Martin & Ravahere`,
        anniversaire: new Date(2005, 3 - 1, 26)
      }, {
        nom: `Christopher & Nadia`,
        anniversaire: new Date(2010, 9 - 1, 4)
      }, {
        nom: `Sandra & Maximin`,
        anniversaire: new Date(2014, 10 - 1, 3)
      }, {
        nom: `Brigitte & Julien`,
        anniversaire: new Date(2016, 2 - 1, 19)
      }
    ];
    familleAnniversaire.sort((a, b) => joursVersAnniversaire(a.anniversaire) - joursVersAnniversaire(b.anniversaire));
    familleAnniversaireMariage.sort((a, b) => joursVersAnniversaire(a.anniversaire) - joursVersAnniversaire(b.anniversaire));
    document.write(`<h2>${dateEnTexte(aujourdhui)}</h2>`);
    document.write(`<h3>Les prochains anniversaires cosmiques:</h3>`)
    document.write(`<br>`);
    familleAnniversaire.forEach(entite => {
      var jVA = joursVersAnniversaire(entite.anniversaire);
      var pA = prochainAnniversaire(entite.anniversaire);
      var texte = `J-${jVA} <b>${entite.nom}</b> (${entite.anniversaire.getFullYear()}, ${entite.signe}) aura <b>${age(entite.anniversaire)} ans</b> le ${dateEnTexte(pA)}.`;
      if (jVA === 0) {
        texte = `🎉🥳 Joyeux anniversaire <b>${entite.nom}</b> (${entite.anniversaire.getFullYear()}, ${entite.signe}) pour tes <b>${age(entite.anniversaire)} ans</b>! <span class="reverse">🥳🎉</span>`;
      }
      document.write(`${texte} <br>`);
    });
    document.write(`<br>`);
    document.write(`<h3>Les prochains anniversaires de mariage:</h3>`);
    document.write(`<br>`);
    familleAnniversaireMariage.forEach(entite => {
      var jVA = joursVersAnniversaire(entite.anniversaire);
      var pA = prochainAnniversaire(entite.anniversaire);
      var texte = `J-${jVA} <b>${entite.nom}</b> (${entite.anniversaire.getFullYear()}) auront <b>${age(entite.anniversaire)} ans</b> de mariage le ${dateEnTexte(pA)}.`;
      if (jVA === 0) {
        texte = `🎉💍 Joyeux anniversaire <b>${entite.nom}</b> (${entite.anniversaire.getFullYear()}) pour ces <b>${age(entite.anniversaire)} ans</b> de mariage! <span class="reverse">💍🎉</span>`;
      }
      document.write(`${texte} <br>`);
    });
    document.write(`<br>`);
    document.write(`Remerciements à Charles qui a grandement simplifié le code.<br>`);
    document.write(`Maj 30 février 2019.<br>`);
    document.write(`Et le 31 mai 2020 😎.<br>`);
    document.write(`<br>`);
  </script>
</body>

</html>
